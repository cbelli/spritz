PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE voting_user (
    user_id integer primary key autoincrement,
    user_name text unique not null,
    pass_word text not null
);
INSERT INTO voting_user VALUES(1,'aldo','aldo');
INSERT INTO voting_user VALUES(2,'beppe','beppe');
INSERT INTO voting_user VALUES(3,'carlo','carlo');
INSERT INTO voting_user VALUES(4,'dario','dario');
INSERT INTO voting_user VALUES(5,'ernesto','ernesto');
INSERT INTO voting_user VALUES(6,'fabio','fabio');
CREATE TABLE votation
(
    votation_id integer primary key autoincrement,
    promoter_user_id integer not null,
    votation_description text unique not null,
    begin_date datetime not null,
    end_date datetime not null,
    votation_type text not null,
    votation_status integer not null
);
INSERT INTO votation VALUES(1,5,'Scelta del t√®','2018-12-10 12:00','2018-12-17 12:00','maj_jud',1);
INSERT INTO votation VALUES(2,5,'Scelta vino',  '2018-12-10 12:00','2018-12-17 12:00','maj_jud',1);
CREATE TABLE guarantor
(
    votation_id integer,
    user_id integer,
    passphrase_ok integer not null,
    hash_ok integer not null,
    order_n integer,
    primary key (votation_id, user_id)
);
CREATE TABLE voting_option
(
    option_id integer PRIMARY KEY autoincrement,
    votation_id integer,
    option_name text,
    description text,
    unique  (votation_id, option_name)
);
INSERT INTO voting_option VALUES(1,1,'Oolong','');
INSERT INTO voting_option VALUES(2,1,'BOP','');
INSERT INTO voting_option VALUES(3,1,'Lapsang sounchong','');
INSERT INTO voting_option VALUES(4,1,'English breakfast','');
INSERT INTO voting_option VALUES(5,2,'Bianco','');
INSERT INTO voting_option VALUES(6,2,'Rosso','');
INSERT INTO voting_option VALUES(7,2,'Rosato','');
INSERT INTO voting_option VALUES(8,2,'Prosecco','');
CREATE TABLE voting_judgement
(
    votation_id integer,
    jud_value integer,
    jud_name text,
    description text,
    primary key (votation_id, jud_value)
);
CREATE TABLE vote
(
    vote_key text,
    votation_id integer,
    option_id integer ,
    jud_value integer,
    primary key (vote_key,votation_id, option_id)
);

CREATE TABLE voter
(
    user_id integer,
    votation_id integer,
    primary key (user_id,votation_id)
);

CREATE TABLE vote_total
(
    votation_id integer,
    option_id integer ,
    jud_value integer,
    vote_count integer,
    primary key (votation_id, option_id,jud_value)
);




DELETE FROM sqlite_sequence;
INSERT INTO sqlite_sequence VALUES('voting_user',6);
INSERT INTO sqlite_sequence VALUES('votation',2);
INSERT INTO sqlite_sequence VALUES('voting_option',8);
COMMIT;


